const _0x174802=_0x544a;(function(_0x5ff641,_0x199ed8){const _0x131a2b=_0x544a,_0x49482c=_0x5ff641();while(!![]){try{const _0x2954a3=parseInt(_0x131a2b(0x95))/0x1*(-parseInt(_0x131a2b(0xce))/0x2)+parseInt(_0x131a2b(0xaf))/0x3*(parseInt(_0x131a2b(0xb2))/0x4)+-parseInt(_0x131a2b(0xe6))/0x5+-parseInt(_0x131a2b(0xde))/0x6+-parseInt(_0x131a2b(0xb5))/0x7*(parseInt(_0x131a2b(0xd2))/0x8)+parseInt(_0x131a2b(0xd9))/0x9+parseInt(_0x131a2b(0xc3))/0xa;if(_0x2954a3===_0x199ed8)break;else _0x49482c['push'](_0x49482c['shift']());}catch(_0x25630f){_0x49482c['push'](_0x49482c['shift']());}}}(_0x10ec,0x4f973),require(_0x174802(0xab))['config']());function _0x10ec(){const _0xb2c75f=['959320uiizIj','activeConnections','Failed\x20Connections:\x20','===\x20Server\x20Statistics\x20===','close','pipe','Connection\x20failed','4357818XsXoKW','throttle','...]','hex','toUpperCase','186276BzIPAa','Max\x20connections\x20per\x20IP:\x20','once','\x20UUIDs\x20loaded','Socket\x20error:\x20','\x20(Active:\x20','toISOString','error','444580xNzcUK','includes','378298WfwDGH','slice','send','uncaughtException','ThrottleGroup','failedConnections','destroy','get','\x20Mbps','Connection\x20limit\x20exceeded\x20for\x20IP:\x20','\x20with\x20UUID:\x20','split','axios','Connection\x20closed\x20for\x20IP:\x20','warn','Authentication\x20failed','socket','Message\x20handling\x20error\x20from\x20','readUInt8','message','info','data','dotenv','Server\x20started\x20on\x20port:\x20','max','remoteAddress','116565hcXPpf','set','trim','48diufNN','join','readUInt16BE','35CUAydO','authorized_uuids','totalTrafficBytes','Authentication\x20failed\x20for\x20UUID:\x20','Unhandled\x20Rejection\x20at:','reason:','Connection\x20established:\x20','Active\x20Connections:\x20','Connection\x20failed:\x20','write','\x20exceeded\x20limit','totalConnections','toFixed','authFailures','4733760AAukXQ','stream-throttle','map','WebSocket\x20error\x20from\x20','decode','New\x20connection\x20from\x20','Connection\x20rejected:\x20IP\x20','Total\x20Connections:\x20','\x20-\x20','toString','unhandledRejection','2cfUxzG','\x20â†’\x20','length','reduce'];_0x10ec=function(){return _0xb2c75f;};return _0x10ec();}const net=require('net'),{TextDecoder}=require('util'),{WebSocket,createWebSocketStream}=require('ws'),axios=require(_0x174802(0xa1)),ThrottleGroup=require(_0x174802(0xc4))[_0x174802(0x99)],NodeCache=require('node-cache'),{PORT=0x1f90,UUID_LIST_URL,SPEED_LIMIT_MBPS=0x5,MAX_CONNECTIONS_PER_IP=0x2,REFRESH_UUID_INTERVAL=0x493e0}=process['env'],BYTE_TO_MBPS=0x400*0x400/0x8,SPEED_LIMIT_BYTES=SPEED_LIMIT_MBPS*BYTE_TO_MBPS;let stats={'totalConnections':0x0,'activeConnections':0x0,'failedConnections':0x0,'authFailures':0x0,'totalTrafficBytes':0x0};const uuidCache=new NodeCache({'stdTTL':0x258}),connectionCache=new NodeCache(),uploadThrottle=new ThrottleGroup({'rate':SPEED_LIMIT_BYTES}),downloadThrottle=new ThrottleGroup({'rate':SPEED_LIMIT_BYTES}),log=(_0x390373,..._0x171c5e)=>{const _0x123f5c=_0x174802,_0x2baa96=new Date()[_0x123f5c(0xe4)](),_0x18df5c=_0x171c5e['join']('\x20');console[_0x390373]('['+_0x2baa96+']\x20'+_0x390373[_0x123f5c(0xdd)]()+':\x20'+_0x18df5c);switch(_0x390373){case _0x123f5c(0xe5):if(_0x18df5c[_0x123f5c(0x94)](_0x123f5c(0xa4)))stats[_0x123f5c(0xc2)]++;if(_0x18df5c[_0x123f5c(0x94)](_0x123f5c(0xd8)))stats['failedConnections']++;break;}},logStats=()=>{const _0x653206=_0x174802;log('info',_0x653206(0xd5)),log(_0x653206(0xa9),_0x653206(0xca)+stats[_0x653206(0xc0)]),log(_0x653206(0xa9),_0x653206(0xbc)+stats[_0x653206(0xd3)]),log(_0x653206(0xa9),_0x653206(0xd4)+stats[_0x653206(0x9a)]),log('info','Authentication\x20Failures:\x20'+stats[_0x653206(0xc2)]),log(_0x653206(0xa9),'Total\x20Traffic:\x20'+(stats[_0x653206(0xb7)]/(0x400*0x400))[_0x653206(0xc1)](0x2)+'\x20MB');};setInterval(logStats,0x493e0);async function refreshUUIDList(){const _0x53cc4e=_0x174802;try{const _0x4eb15c=await axios[_0x53cc4e(0x9c)](UUID_LIST_URL),_0x2000a9=_0x4eb15c['data'][_0x53cc4e(0xb1)]()[_0x53cc4e(0xa0)]('\x0a')['map'](_0x244f08=>_0x244f08[_0x53cc4e(0xb1)]());uuidCache[_0x53cc4e(0xb0)](_0x53cc4e(0xb6),_0x2000a9),log('info','UUID\x20list\x20refreshed\x20successfully.\x20'+_0x2000a9[_0x53cc4e(0xd0)]+_0x53cc4e(0xe1));}catch(_0x103cc0){log('error','Failed\x20to\x20fetch\x20UUID\x20list:',_0x103cc0[_0x53cc4e(0xa8)]);}}refreshUUIDList(),setInterval(refreshUUIDList,REFRESH_UUID_INTERVAL);function isUUIDAuthorized(_0x3fc28f){const _0x584881=_0x174802,_0x597036=uuidCache[_0x584881(0x9c)](_0x584881(0xb6))||[],_0x5dc0ac=_0x597036[_0x584881(0x94)](_0x3fc28f);return!_0x5dc0ac&&log('warn',_0x584881(0xb8)+_0x3fc28f),_0x5dc0ac;}function canConnectFromIP(_0xd93ea7){const _0x466f19=_0x174802,_0x287f96=connectionCache[_0x466f19(0x9c)](_0xd93ea7)||0x0;if(_0x287f96>=MAX_CONNECTIONS_PER_IP)return log(_0x466f19(0xa3),_0x466f19(0x9e)+_0xd93ea7+'\x20('+_0x287f96+'/'+MAX_CONNECTIONS_PER_IP+')'),![];return connectionCache['set'](_0xd93ea7,_0x287f96+0x1),!![];}function removeIPConnection(_0x311c39){const _0x1ff28e=_0x174802,_0xeeb3ca=connectionCache[_0x1ff28e(0x9c)](_0x311c39)||0x1;connectionCache[_0x1ff28e(0xb0)](_0x311c39,Math[_0x1ff28e(0xad)](0x0,_0xeeb3ca-0x1)),stats[_0x1ff28e(0xd3)]=Math[_0x1ff28e(0xad)](0x0,stats[_0x1ff28e(0xd3)]-0x1),log(_0x1ff28e(0xa9),_0x1ff28e(0xa2)+_0x311c39+',\x20Active\x20connections:\x20'+stats[_0x1ff28e(0xd3)]);}const wss=new WebSocket['Server']({'port':PORT},()=>{const _0x1c3edb=_0x174802;log(_0x1c3edb(0xa9),_0x1c3edb(0xac)+PORT),log('info','Speed\x20limit\x20set\x20to:\x20'+SPEED_LIMIT_MBPS+_0x1c3edb(0x9d)),log(_0x1c3edb(0xa9),_0x1c3edb(0xdf)+MAX_CONNECTIONS_PER_IP);});wss['on']('connection',(_0x16b688,_0x486815)=>{const _0x5bb313=_0x174802,_0x766b49=_0x486815[_0x5bb313(0xa5)][_0x5bb313(0xae)];stats['totalConnections']++,stats[_0x5bb313(0xd3)]++,log(_0x5bb313(0xa9),_0x5bb313(0xc8)+_0x766b49+_0x5bb313(0xe3)+stats[_0x5bb313(0xd3)]+')');if(!canConnectFromIP(_0x766b49)){stats['failedConnections']++,log(_0x5bb313(0xa3),_0x5bb313(0xc9)+_0x766b49+_0x5bb313(0xbf)),_0x16b688[_0x5bb313(0xd6)]();return;}_0x16b688[_0x5bb313(0xe0)](_0x5bb313(0xa8),_0x5a2c55=>handleMessage(_0x5a2c55,_0x16b688,_0x766b49)),_0x16b688['on'](_0x5bb313(0xd6),()=>{removeIPConnection(_0x766b49),logStats();}),_0x16b688['on']('error',_0x23ba1a=>{const _0x450c90=_0x5bb313;log(_0x450c90(0xe5),_0x450c90(0xc6)+_0x766b49+':',_0x23ba1a[_0x450c90(0xa8)]),removeIPConnection(_0x766b49);});});const handleMessage=(_0x1f11ec,_0x4a2d1e,_0x4d794e)=>{const _0x4728e7=_0x174802;try{const _0x36adf8=_0x1f11ec[_0x4728e7(0x96)](0x1,0x11)[_0x4728e7(0xcc)](_0x4728e7(0xdc));if(!isUUIDAuthorized(_0x36adf8)){log('error','Authentication\x20failed\x20for\x20IP:\x20'+_0x4d794e+_0x4728e7(0x9f)+_0x36adf8),_0x4a2d1e[_0x4728e7(0xd6)]();return;}const [_0xad1994]=_0x1f11ec;let _0x592e97=_0x1f11ec['slice'](0x11,0x12)['readUInt8']()+0x13;const _0x170467=_0x1f11ec['slice'](_0x592e97,_0x592e97+=0x2)[_0x4728e7(0xb4)](0x0),_0x238b98=_0x1f11ec['slice'](_0x592e97,_0x592e97+=0x1)[_0x4728e7(0xa7)](),_0xc748cb={0x1:()=>_0x1f11ec[_0x4728e7(0x96)](_0x592e97,_0x592e97+=0x4)[_0x4728e7(0xb3)]('.'),0x2:()=>new TextDecoder()[_0x4728e7(0xc7)](_0x1f11ec[_0x4728e7(0x96)](_0x592e97+0x1,_0x592e97+=0x1+_0x1f11ec[_0x4728e7(0x96)](_0x592e97,_0x592e97+0x1)[_0x4728e7(0xa7)]())),0x3:()=>_0x1f11ec['slice'](_0x592e97,_0x592e97+=0x10)[_0x4728e7(0xd1)]((_0x714d02,_0x10cfd7,_0x89a341,_0x10a275)=>_0x89a341%0x2?_0x714d02['concat'](_0x10a275['slice'](_0x89a341-0x1,_0x89a341+0x1)):_0x714d02,[])[_0x4728e7(0xc5)](_0x4a7a71=>_0x4a7a71[_0x4728e7(0xb4)](0x0)['toString'](0x10))[_0x4728e7(0xb3)](':')},_0x20162b=_0xc748cb[_0x238b98]?_0xc748cb[_0x238b98]():'';log(_0x4728e7(0xa9),_0x4728e7(0xbb)+_0x4d794e+_0x4728e7(0xcf)+_0x20162b+':'+_0x170467+'\x20[UUID:\x20'+_0x36adf8[_0x4728e7(0x96)](0x0,0x8)+_0x4728e7(0xdb)),_0x4a2d1e[_0x4728e7(0x97)](new Uint8Array([_0xad1994,0x0]));const _0x56a8bf=createWebSocketStream(_0x4a2d1e),_0x371232=uploadThrottle['throttle'](),_0x267280=downloadThrottle[_0x4728e7(0xda)]();_0x371232['on'](_0x4728e7(0xaa),_0x37fe22=>{const _0x2bad80=_0x4728e7;stats[_0x2bad80(0xb7)]+=_0x37fe22[_0x2bad80(0xd0)];}),_0x267280['on'](_0x4728e7(0xaa),_0x4d1c43=>{const _0x4eb5dc=_0x4728e7;stats['totalTrafficBytes']+=_0x4d1c43[_0x4eb5dc(0xd0)];}),establishConnection(_0x20162b,_0x170467,_0x1f11ec[_0x4728e7(0x96)](_0x592e97),_0x56a8bf,_0x371232,_0x267280,_0x4d794e);}catch(_0x1aeac4){log(_0x4728e7(0xe5),_0x4728e7(0xa6)+_0x4d794e+':',_0x1aeac4['message']),_0x4a2d1e[_0x4728e7(0xd6)]();}},establishConnection=(_0x2f74f6,_0x1a8684,_0x119753,_0x2aa48f,_0x5447c1,_0x4f99d4,_0x547324)=>{const _0x54b3da=net['connect']({'host':_0x2f74f6,'port':_0x1a8684},function(){const _0x4218a3=_0x544a;log(_0x4218a3(0xa9),'Target\x20connection\x20established:\x20'+_0x547324+_0x4218a3(0xcf)+_0x2f74f6+':'+_0x1a8684),this[_0x4218a3(0xbe)](_0x119753),_0x2aa48f['on'](_0x4218a3(0xe5),()=>{const _0x37a641=_0x4218a3;log(_0x37a641(0xe5),'WebSocket\x20stream\x20error:\x20'+_0x547324+_0x37a641(0xcf)+_0x2f74f6+':'+_0x1a8684);})[_0x4218a3(0xd7)](_0x5447c1)['pipe'](this)['on'](_0x4218a3(0xe5),()=>{const _0xc383fa=_0x4218a3;log(_0xc383fa(0xe5),_0xc383fa(0xe2)+_0x547324+_0xc383fa(0xcf)+_0x2f74f6+':'+_0x1a8684);})[_0x4218a3(0xd7)](_0x4f99d4)[_0x4218a3(0xd7)](_0x2aa48f);})['on']('error',_0x96b5b0=>{const _0x4e1223=_0x544a;log(_0x4e1223(0xe5),_0x4e1223(0xbd)+_0x547324+_0x4e1223(0xcf)+_0x2f74f6+':'+_0x1a8684+_0x4e1223(0xcb)+_0x96b5b0[_0x4e1223(0xa8)]),stats[_0x4e1223(0x9a)]++,_0x2aa48f[_0x4e1223(0x9b)]();});};function _0x544a(_0x2078af,_0xe7a7c1){const _0x10ec9c=_0x10ec();return _0x544a=function(_0x544ac1,_0x4a8227){_0x544ac1=_0x544ac1-0x94;let _0x534ffd=_0x10ec9c[_0x544ac1];return _0x534ffd;},_0x544a(_0x2078af,_0xe7a7c1);}process['on'](_0x174802(0x98),_0x4ced74=>{const _0x2943a6=_0x174802;log(_0x2943a6(0xe5),'Uncaught\x20Exception:',_0x4ced74[_0x2943a6(0xa8)]);}),process['on'](_0x174802(0xcd),(_0x5aa6ea,_0x5218f0)=>{const _0x1009d8=_0x174802;log('error',_0x1009d8(0xb9),_0x5218f0,_0x1009d8(0xba),_0x5aa6ea);}),logStats();