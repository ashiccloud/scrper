const _0x420a48=_0x2196;(function(_0x53cf01,_0x34a1ba){const _0x49c9ae=_0x2196,_0x2c4cad=_0x53cf01();while(!![]){try{const _0x402da3=-parseInt(_0x49c9ae(0xf6))/0x1*(parseInt(_0x49c9ae(0xd7))/0x2)+parseInt(_0x49c9ae(0xac))/0x3+parseInt(_0x49c9ae(0xd0))/0x4*(-parseInt(_0x49c9ae(0xdf))/0x5)+parseInt(_0x49c9ae(0xb4))/0x6*(-parseInt(_0x49c9ae(0xeb))/0x7)+parseInt(_0x49c9ae(0xe4))/0x8+parseInt(_0x49c9ae(0xe1))/0x9*(parseInt(_0x49c9ae(0xd9))/0xa)+parseInt(_0x49c9ae(0xbe))/0xb;if(_0x402da3===_0x34a1ba)break;else _0x2c4cad['push'](_0x2c4cad['shift']());}catch(_0xdd3aa4){_0x2c4cad['push'](_0x2c4cad['shift']());}}}(_0x5245,0x57b66),require('dotenv')['config']());function _0x2196(_0x1c0a23,_0x2ce1d9){const _0x52452c=_0x5245();return _0x2196=function(_0x219642,_0x4c18fb){_0x219642=_0x219642-0xa5;let _0x1782a4=_0x52452c[_0x219642];return _0x1782a4;},_0x2196(_0x1c0a23,_0x2ce1d9);}const net=require(_0x420a48(0xbd)),{TextDecoder}=require(_0x420a48(0xb7)),{WebSocket,createWebSocketStream}=require('ws'),axios=require(_0x420a48(0xe9)),ThrottleGroup=require(_0x420a48(0xc8))['ThrottleGroup'],NodeCache=require('node-cache'),{PORT=0x1f90,UUID_LIST_URL,SPEED_LIMIT_MBPS=0x5,MAX_CONNECTIONS_PER_IP=0x2,REFRESH_UUID_INTERVAL=0x493e0}=process['env'],BYTE_TO_MBPS=0x400*0x400/0x8,SPEED_LIMIT_BYTES=SPEED_LIMIT_MBPS*BYTE_TO_MBPS;let stats={'totalConnections':0x0,'activeConnections':0x0,'failedConnections':0x0,'authFailures':0x0,'totalTrafficBytes':0x0};const uuidCache=new NodeCache({'stdTTL':0x258}),connectionCache=new NodeCache(),uploadThrottle=new ThrottleGroup({'rate':SPEED_LIMIT_BYTES}),downloadThrottle=new ThrottleGroup({'rate':SPEED_LIMIT_BYTES}),log=(_0x2b19ff,..._0x5291a9)=>{const _0x46e04e=_0x420a48,_0x4f156f=new Date()['toISOString'](),_0x39d74e=_0x5291a9['join']('\x20');console[_0x2b19ff]('['+_0x4f156f+']\x20'+_0x2b19ff['toUpperCase']()+':\x20'+_0x39d74e);switch(_0x2b19ff){case _0x46e04e(0xc1):if(_0x39d74e['includes'](_0x46e04e(0xbf)))stats[_0x46e04e(0xc6)]++;if(_0x39d74e[_0x46e04e(0xaa)](_0x46e04e(0xb3)))stats[_0x46e04e(0xe7)]++;break;}},logStats=()=>{const _0xc93dc5=_0x420a48;log('info',_0xc93dc5(0xc3)),log(_0xc93dc5(0xb0),_0xc93dc5(0xba)+stats[_0xc93dc5(0xca)]),log('info',_0xc93dc5(0xb6)+stats[_0xc93dc5(0xab)]),log(_0xc93dc5(0xb0),_0xc93dc5(0xf0)+stats[_0xc93dc5(0xe7)]),log(_0xc93dc5(0xb0),'Authentication\x20Failures:\x20'+stats['authFailures']),log(_0xc93dc5(0xb0),_0xc93dc5(0xe3)+(stats[_0xc93dc5(0xcd)]/(0x400*0x400))['toFixed'](0x2)+_0xc93dc5(0xe5));};setInterval(logStats,0x493e0);function normalizeUUID(_0x840b74){const _0x201829=_0x420a48;return _0x840b74[_0x201829(0xb8)](/-/g,'')['toLowerCase']();}async function refreshUUIDList(){const _0x3036aa=_0x420a48;try{const _0x297395=await axios['get'](UUID_LIST_URL),_0xbea9a3=_0x297395[_0x3036aa(0xa7)][_0x3036aa(0xc4)]()[_0x3036aa(0xdd)]('\x0a')['map'](_0x5659bb=>normalizeUUID(_0x5659bb[_0x3036aa(0xc4)]()));uuidCache[_0x3036aa(0xc2)](_0x3036aa(0xef),_0xbea9a3),log(_0x3036aa(0xb0),'UUID\x20list\x20refreshed\x20successfully.\x20'+_0xbea9a3[_0x3036aa(0xaf)]+_0x3036aa(0xd2));}catch(_0xe1df75){log(_0x3036aa(0xc1),_0x3036aa(0xdb),_0xe1df75[_0x3036aa(0xa5)]);}}refreshUUIDList(),setInterval(refreshUUIDList,REFRESH_UUID_INTERVAL);function isUUIDAuthorized(_0x427db6){const _0x3229b2=_0x420a48,_0x148a15=uuidCache['get'](_0x3229b2(0xef))||[],_0x1fa27a=normalizeUUID(_0x427db6),_0x388a6b=_0x148a15[_0x3229b2(0xaa)](_0x1fa27a);return!_0x388a6b&&log(_0x3229b2(0xae),_0x3229b2(0xb2)+_0x427db6),_0x388a6b;}function canConnectFromIP(_0x1d98df){const _0x177478=_0x420a48,_0x571167=connectionCache['get'](_0x1d98df)||0x0;if(_0x571167>=MAX_CONNECTIONS_PER_IP)return log(_0x177478(0xae),_0x177478(0xb1)+_0x1d98df+'\x20('+_0x571167+'/'+MAX_CONNECTIONS_PER_IP+')'),![];return connectionCache[_0x177478(0xc2)](_0x1d98df,_0x571167+0x1),!![];}function removeIPConnection(_0x11e554){const _0x1b0662=_0x420a48,_0x49021c=connectionCache[_0x1b0662(0xf5)](_0x11e554)||0x1;connectionCache[_0x1b0662(0xc2)](_0x11e554,Math[_0x1b0662(0xe0)](0x0,_0x49021c-0x1)),stats[_0x1b0662(0xab)]=Math[_0x1b0662(0xe0)](0x0,stats[_0x1b0662(0xab)]-0x1),log(_0x1b0662(0xb0),'Connection\x20closed\x20for\x20IP:\x20'+_0x11e554+_0x1b0662(0xc9)+stats[_0x1b0662(0xab)]);}const wss=new WebSocket[(_0x420a48(0xe6))]({'port':PORT},()=>{const _0x4d8e51=_0x420a48;log(_0x4d8e51(0xb0),_0x4d8e51(0xf2)+PORT),log(_0x4d8e51(0xb0),_0x4d8e51(0xf8)+SPEED_LIMIT_MBPS+'\x20Mbps'),log('info',_0x4d8e51(0xa9)+MAX_CONNECTIONS_PER_IP);});wss['on']('connection',(_0x47890b,_0x12598e)=>{const _0x4691e0=_0x420a48,_0x3e1bca=_0x12598e[_0x4691e0(0xf4)][_0x4691e0(0xf1)];stats['totalConnections']++,stats[_0x4691e0(0xab)]++,log(_0x4691e0(0xb0),_0x4691e0(0xd5)+_0x3e1bca+'\x20(Active:\x20'+stats[_0x4691e0(0xab)]+')');if(!canConnectFromIP(_0x3e1bca)){stats['failedConnections']++,log(_0x4691e0(0xae),_0x4691e0(0xc0)+_0x3e1bca+_0x4691e0(0xdc)),_0x47890b[_0x4691e0(0xc7)]();return;}_0x47890b[_0x4691e0(0xd8)](_0x4691e0(0xa5),_0x58bbce=>handleMessage(_0x58bbce,_0x47890b,_0x3e1bca)),_0x47890b['on'](_0x4691e0(0xc7),()=>{removeIPConnection(_0x3e1bca),logStats();}),_0x47890b['on'](_0x4691e0(0xc1),_0xdf8a5b=>{const _0x2802b4=_0x4691e0;log(_0x2802b4(0xc1),'WebSocket\x20error\x20from\x20'+_0x3e1bca+':',_0xdf8a5b[_0x2802b4(0xa5)]),removeIPConnection(_0x3e1bca);});});function _0x5245(){const _0x5f10fb=['Connection\x20failed','66348lilaXo','Connection\x20failed:\x20','Active\x20Connections:\x20','util','replace','concat','Total\x20Connections:\x20','Connection\x20established:\x20','throttle','net','10781430CMhMFb','Authentication\x20failed','Connection\x20rejected:\x20IP\x20','error','set','===\x20Server\x20Statistics\x20===','trim','...]','authFailures','close','stream-throttle',',\x20Active\x20connections:\x20','totalConnections','decode','Unhandled\x20Rejection\x20at:','totalTrafficBytes','readUInt16BE','\x20→\x20','8xieakB','destroy','\x20UUIDs\x20loaded','reduce','pipe','New\x20connection\x20from\x20','write','276954XVJfAr','once','320ykzmcj','Message\x20handling\x20error\x20from\x20','Failed\x20to\x20fetch\x20UUID\x20list:','\x20exceeded\x20limit','split','\x20[UUID:\x20','994340MNDmOu','max','19827OLCXFe','readUInt8','Total\x20Traffic:\x20','2550936kHDOyH','\x20MB','Server','failedConnections','hex','axios','WebSocket\x20stream\x20error:\x20','413wVZaOQ','slice','unhandledRejection','send','authorized_uuids','Failed\x20Connections:\x20','remoteAddress','Server\x20started\x20on\x20port:\x20','Socket\x20error:\x20','socket','get','1IdkQGS','Uncaught\x20Exception:','Speed\x20limit\x20set\x20to:\x20','join','message','toString','data','\x20-\x20','Max\x20connections\x20per\x20IP:\x20','includes','activeConnections','535236VnIfKR','reason:','warn','length','info','Connection\x20limit\x20exceeded\x20for\x20IP:\x20','Authentication\x20failed\x20for\x20UUID:\x20'];_0x5245=function(){return _0x5f10fb;};return _0x5245();}const handleMessage=(_0x410f3a,_0x4c7dc1,_0x455548)=>{const _0x488e31=_0x420a48;try{const _0x2af18c=_0x410f3a[_0x488e31(0xec)](0x1,0x11)[_0x488e31(0xa6)](_0x488e31(0xe8));if(!isUUIDAuthorized(_0x2af18c)){log(_0x488e31(0xc1),'Authentication\x20failed\x20for\x20IP:\x20'+_0x455548+'\x20with\x20UUID:\x20'+_0x2af18c),_0x4c7dc1['close']();return;}const [_0x14f8f6]=_0x410f3a;let _0xb97d63=_0x410f3a[_0x488e31(0xec)](0x11,0x12)[_0x488e31(0xe2)]()+0x13;const _0x5005f9=_0x410f3a[_0x488e31(0xec)](_0xb97d63,_0xb97d63+=0x2)[_0x488e31(0xce)](0x0),_0x3d8ec7=_0x410f3a[_0x488e31(0xec)](_0xb97d63,_0xb97d63+=0x1)[_0x488e31(0xe2)](),_0x4a7aa1={0x1:()=>_0x410f3a[_0x488e31(0xec)](_0xb97d63,_0xb97d63+=0x4)[_0x488e31(0xf9)]('.'),0x2:()=>new TextDecoder()[_0x488e31(0xcb)](_0x410f3a['slice'](_0xb97d63+0x1,_0xb97d63+=0x1+_0x410f3a['slice'](_0xb97d63,_0xb97d63+0x1)['readUInt8']())),0x3:()=>_0x410f3a['slice'](_0xb97d63,_0xb97d63+=0x10)[_0x488e31(0xd3)]((_0x50a1c0,_0x51326a,_0xc4e218,_0x193520)=>_0xc4e218%0x2?_0x50a1c0[_0x488e31(0xb9)](_0x193520['slice'](_0xc4e218-0x1,_0xc4e218+0x1)):_0x50a1c0,[])['map'](_0x3e09f6=>_0x3e09f6[_0x488e31(0xce)](0x0)[_0x488e31(0xa6)](0x10))[_0x488e31(0xf9)](':')},_0x808323=_0x4a7aa1[_0x3d8ec7]?_0x4a7aa1[_0x3d8ec7]():'';log(_0x488e31(0xb0),_0x488e31(0xbb)+_0x455548+_0x488e31(0xcf)+_0x808323+':'+_0x5005f9+_0x488e31(0xde)+_0x2af18c[_0x488e31(0xec)](0x0,0x8)+_0x488e31(0xc5)),_0x4c7dc1[_0x488e31(0xee)](new Uint8Array([_0x14f8f6,0x0]));const _0x4b5101=createWebSocketStream(_0x4c7dc1),_0x589033=uploadThrottle[_0x488e31(0xbc)](),_0x42d5bd=downloadThrottle[_0x488e31(0xbc)]();_0x589033['on'](_0x488e31(0xa7),_0x4533c2=>{const _0x20545a=_0x488e31;stats[_0x20545a(0xcd)]+=_0x4533c2[_0x20545a(0xaf)];}),_0x42d5bd['on'](_0x488e31(0xa7),_0x458b47=>{const _0x2ce536=_0x488e31;stats[_0x2ce536(0xcd)]+=_0x458b47[_0x2ce536(0xaf)];}),establishConnection(_0x808323,_0x5005f9,_0x410f3a[_0x488e31(0xec)](_0xb97d63),_0x4b5101,_0x589033,_0x42d5bd,_0x455548);}catch(_0x4b921c){log(_0x488e31(0xc1),_0x488e31(0xda)+_0x455548+':',_0x4b921c[_0x488e31(0xa5)]),_0x4c7dc1[_0x488e31(0xc7)]();}},establishConnection=(_0x2a479b,_0x4a7629,_0x21524f,_0x4ec64c,_0x43668e,_0x45302f,_0x47570c)=>{const _0x3d0436=_0x420a48,_0x3bab87=net['connect']({'host':_0x2a479b,'port':_0x4a7629},function(){const _0x3088cb=_0x2196;log('info','Target\x20connection\x20established:\x20'+_0x47570c+'\x20→\x20'+_0x2a479b+':'+_0x4a7629),this[_0x3088cb(0xd6)](_0x21524f),_0x4ec64c['on']('error',()=>{const _0xe53d0d=_0x3088cb;log(_0xe53d0d(0xc1),_0xe53d0d(0xea)+_0x47570c+'\x20→\x20'+_0x2a479b+':'+_0x4a7629);})[_0x3088cb(0xd4)](_0x43668e)['pipe'](this)['on']('error',()=>{const _0x1c3e75=_0x3088cb;log(_0x1c3e75(0xc1),_0x1c3e75(0xf3)+_0x47570c+_0x1c3e75(0xcf)+_0x2a479b+':'+_0x4a7629);})[_0x3088cb(0xd4)](_0x45302f)[_0x3088cb(0xd4)](_0x4ec64c);})['on'](_0x3d0436(0xc1),_0x52051c=>{const _0x46fba2=_0x3d0436;log(_0x46fba2(0xc1),_0x46fba2(0xb5)+_0x47570c+_0x46fba2(0xcf)+_0x2a479b+':'+_0x4a7629+_0x46fba2(0xa8)+_0x52051c[_0x46fba2(0xa5)]),stats['failedConnections']++,_0x4ec64c[_0x46fba2(0xd1)]();});};process['on']('uncaughtException',_0x2680d4=>{const _0x5b16eb=_0x420a48;log(_0x5b16eb(0xc1),_0x5b16eb(0xf7),_0x2680d4['message']);}),process['on'](_0x420a48(0xed),(_0x327c27,_0x39bbe2)=>{const _0x2520b0=_0x420a48;log(_0x2520b0(0xc1),_0x2520b0(0xcc),_0x39bbe2,_0x2520b0(0xad),_0x327c27);}),logStats();