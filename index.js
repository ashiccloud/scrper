function _0x3bba(){const _0x4c07ee=['dotenv','375360EFSTir','SIGTERM','util','Connection\x20timeout','readBytes','MAX_PAYLOAD_SIZE','PORT','430794ofsFqe','pipe','net','message','32TtPvpr','authorizedUUIDs','exit','connectionManager','Uncaught\x20Exception:','setupServer','WebSocket\x20stream\x20error\x20for\x20','readUInt8','data','UUID_REFRESH_INTERVAL','setupUUIDRefresh','forEach','rateLimiters','version','length','now','toString','toISOString','Socket\x20stream\x20error\x20for\x20','clients','port','set','addConnection','LOG_LEVEL','435879WSEkXF','close','UUID_PASTEBIN_URL','connections','.\x20Starting\x20graceful\x20shutdown...','uuid','connect','3700240HqHEVf','112790hSXNre','test','host','Missing\x20required\x20environment\x20variable:\x20','config','RATE_LIMIT_BYTES','has','Server\x20shutting\x20down','Invalid\x20message\x20length','\x20from\x20IP:\x20','Connection\x20limit\x20exceeded\x20for\x20IP:\x20','parseAddress','destroy','OPEN','SIGINT','readyState','Unauthorized','split','warn','toUpperCase','\x20Mbps\x20per\x20connection','trim','Server','setupErrorHandlers','pong','log','138pYJIcR','once','error','size','reason:','parse','slice','Connection\x20timeout\x20to\x20','Unsupported\x20address\x20type:\x20','readUInt16BE','Server\x20started\x20with\x20rate\x20limit\x20of\x20','updateAuthorizedUUIDs','wss','uncaughtException','Updated\x20authorized\x20UUIDs.\x20Count:\x20','unhandledRejection','delete','msg','establishConnection','removeConnection','Invalid\x20message\x20format','CONNECTION_TIMEOUT','get','hex','env','map','handleMessage','axios','filter','MAX_CONNECTIONS_PER_IP','throttle','send','write','join','offset','info','9239gzGBXv','crypto','isAlive','connection','Received\x20','terminate','Error\x20handling\x20message\x20from\x20','18Uhjgwi','WebSocket\x20server\x20closed','1851732DIEFJm','utf8','isRateLimited','RATE_LIMIT_BPS','Too\x20many\x20connections','Server\x20is\x20listening\x20on\x20port:'];_0x3bba=function(){return _0x4c07ee;};return _0x3bba();}const _0x67e027=_0x1b7d;function _0x1b7d(_0x1a7cba,_0x7551f){const _0x3bba2a=_0x3bba();return _0x1b7d=function(_0x1b7d69,_0x69dd49){_0x1b7d69=_0x1b7d69-0x1d6;let _0x588739=_0x3bba2a[_0x1b7d69];return _0x588739;},_0x1b7d(_0x1a7cba,_0x7551f);}(function(_0x3a3609,_0x16df33){const _0x4256ee=_0x1b7d,_0x1edf4f=_0x3a3609();while(!![]){try{const _0x579ae5=-parseInt(_0x4256ee(0x1f0))/0x1*(-parseInt(_0x4256ee(0x245))/0x2)+-parseInt(_0x4256ee(0x1f9))/0x3+-parseInt(_0x4256ee(0x200))/0x4+parseInt(_0x4256ee(0x22b))/0x5+-parseInt(_0x4256ee(0x1f7))/0x6*(parseInt(_0x4256ee(0x207))/0x7)+parseInt(_0x4256ee(0x20b))/0x8*(parseInt(_0x4256ee(0x223))/0x9)+parseInt(_0x4256ee(0x22a))/0xa;if(_0x579ae5===_0x16df33)break;else _0x1edf4f['push'](_0x1edf4f['shift']());}catch(_0x428a46){_0x1edf4f['push'](_0x1edf4f['shift']());}}}(_0x3bba,0x50197),require(_0x67e027(0x1ff))[_0x67e027(0x22f)]());const net=require(_0x67e027(0x209)),{TextDecoder}=require(_0x67e027(0x202)),{WebSocket,createWebSocketStream}=require('ws'),axios=require(_0x67e027(0x1e7)),ThrottleStream=require(_0x67e027(0x1ea)),crypto=require(_0x67e027(0x1f1)),config={'RATE_LIMIT_BPS':0x4c4b40,'RATE_LIMIT_BYTES':0x4c4b40/0x8,'UUID_REFRESH_INTERVAL':0x5*0x3c*0x3e8,'MAX_CONNECTIONS_PER_IP':0xa,'CONNECTION_TIMEOUT':0x7530,'HEARTBEAT_INTERVAL':0x7530,'MAX_PAYLOAD_SIZE':0x400*0x400},requiredEnvVars=[_0x67e027(0x225),_0x67e027(0x206)];for(const envVar of requiredEnvVars){if(!process['env'][envVar])throw new Error(_0x67e027(0x22e)+envVar);}class ConnectionManager{constructor(){const _0x36a3f9=_0x67e027;this[_0x36a3f9(0x226)]=new Map(),this[_0x36a3f9(0x20c)]=new Set(),this[_0x36a3f9(0x217)]=new Map();}[_0x67e027(0x221)](_0x16ee29){const _0x3a2667=_0x67e027,_0x1d264f=(this[_0x3a2667(0x226)][_0x3a2667(0x1e2)](_0x16ee29)||0x0)+0x1;return this['connections']['set'](_0x16ee29,_0x1d264f),_0x1d264f<=config[_0x3a2667(0x1e9)];}[_0x67e027(0x1df)](_0x22fba5){const _0x587081=_0x67e027,_0x37102d=this[_0x587081(0x226)][_0x587081(0x1e2)](_0x22fba5)-0x1;_0x37102d<=0x0?this['connections'][_0x587081(0x1dc)](_0x22fba5):this['connections'][_0x587081(0x220)](_0x22fba5,_0x37102d);}[_0x67e027(0x1fb)](_0x160af1){const _0x109539=_0x67e027,_0x1da21e=Date[_0x109539(0x21a)](),_0x1aef47=this[_0x109539(0x217)][_0x109539(0x1e2)](_0x160af1)||0x0;if(_0x1da21e-_0x1aef47<0x3e8)return!![];return this[_0x109539(0x217)]['set'](_0x160af1,_0x1da21e),![];}async['updateAuthorizedUUIDs'](){const _0x24f40a=_0x67e027;try{const _0x30d43d=await axios['get'](process[_0x24f40a(0x1e4)][_0x24f40a(0x225)],{'timeout':0x1388,'headers':{'User-Agent':'WebSocket-Proxy-Server/1.0'}}),_0x495989=_0x30d43d[_0x24f40a(0x213)][_0x24f40a(0x240)]()[_0x24f40a(0x23c)]('\x0a')[_0x24f40a(0x1e5)](_0x59c7f2=>_0x59c7f2['replace'](/-/g,'')[_0x24f40a(0x240)]())[_0x24f40a(0x1e8)](_0x524b75=>/^[a-f0-9]{32}$/i[_0x24f40a(0x22c)](_0x524b75));this['authorizedUUIDs']=new Set(_0x495989),log(_0x24f40a(0x1ef),_0x24f40a(0x1da)+this[_0x24f40a(0x20c)][_0x24f40a(0x248)]);}catch(_0x434edc){log('error','Failed\x20to\x20fetch\x20UUIDs:',_0x434edc['message']);}}}const log=(_0x2bbb7f,..._0x2d9bf6)=>{const _0x4c6b39=_0x67e027,_0x5ae8d0=new Date()[_0x4c6b39(0x21c)](),_0x49893a=process[_0x4c6b39(0x1e4)][_0x4c6b39(0x222)]||_0x4c6b39(0x1ef),_0x1653d7={'error':0x0,'warn':0x1,'info':0x2,'debug':0x3};_0x1653d7[_0x2bbb7f]<=_0x1653d7[_0x49893a]&&(console[_0x2bbb7f]||console[_0x4c6b39(0x244)]('['+_0x5ae8d0+']\x20'+_0x2bbb7f[_0x4c6b39(0x23e)]()+':',..._0x2d9bf6));};class WebSocketProxyServer{constructor(){const _0x4376a1=_0x67e027;this[_0x4376a1(0x20e)]=new ConnectionManager(),this[_0x4376a1(0x210)](),this[_0x4376a1(0x215)](),this[_0x4376a1(0x242)]();}[_0x67e027(0x210)](){const _0x541ca8=_0x67e027;this[_0x541ca8(0x1d8)]=new WebSocket[(_0x541ca8(0x241))]({'port':process[_0x541ca8(0x1e4)][_0x541ca8(0x206)],'perMessageDeflate':![],'maxPayload':config[_0x541ca8(0x205)]},()=>log(_0x541ca8(0x1ef),_0x541ca8(0x1fe),process[_0x541ca8(0x1e4)][_0x541ca8(0x206)])),this['wss']['on'](_0x541ca8(0x1f3),(_0x15c22e,_0x7c79fd)=>{const _0x3d195a=_0x541ca8,_0x4effd2=_0x7c79fd['socket']['remoteAddress'];if(this['connectionManager'][_0x3d195a(0x1fb)](_0x4effd2)){log(_0x3d195a(0x23d),'Rate\x20limit\x20exceeded\x20for\x20IP:\x20'+_0x4effd2),_0x15c22e['close'](0x3f0,'Rate\x20limit\x20exceeded');return;}if(!this[_0x3d195a(0x20e)]['addConnection'](_0x4effd2)){log(_0x3d195a(0x23d),_0x3d195a(0x235)+_0x4effd2),_0x15c22e[_0x3d195a(0x224)](0x3f0,_0x3d195a(0x1fd));return;}_0x15c22e[_0x3d195a(0x1f2)]=!![],_0x15c22e['on'](_0x3d195a(0x243),()=>{const _0x243b4f=_0x3d195a;_0x15c22e[_0x243b4f(0x1f2)]=!![];});const _0x5f06af=setTimeout(()=>{const _0x8c4b42=_0x3d195a;_0x15c22e[_0x8c4b42(0x23a)]===WebSocket[_0x8c4b42(0x238)]&&_0x15c22e[_0x8c4b42(0x224)](0x3e8,_0x8c4b42(0x203));},config[_0x3d195a(0x1e1)]);_0x15c22e[_0x3d195a(0x246)](_0x3d195a(0x20a),_0x419f8d=>{const _0x2c4a01=_0x3d195a;clearTimeout(_0x5f06af),this[_0x2c4a01(0x1e6)](_0x419f8d,_0x15c22e,_0x4effd2);}),_0x15c22e['on']('close',()=>{const _0x22a334=_0x3d195a;this[_0x22a334(0x20e)][_0x22a334(0x1df)](_0x4effd2),clearTimeout(_0x5f06af);});}),setInterval(()=>{const _0x386851=_0x541ca8;this['wss'][_0x386851(0x21e)][_0x386851(0x216)](_0x25d1ce=>{const _0x3e5539=_0x386851;if(_0x25d1ce[_0x3e5539(0x1f2)]===![])return _0x25d1ce[_0x3e5539(0x1f5)]();_0x25d1ce['isAlive']=![],_0x25d1ce['ping'](()=>{});});},config['HEARTBEAT_INTERVAL']);}[_0x67e027(0x215)](){const _0x380534=_0x67e027;this[_0x380534(0x20e)][_0x380534(0x1d7)](),setInterval(()=>{const _0x41907b=_0x380534;this[_0x41907b(0x20e)][_0x41907b(0x1d7)]();},config[_0x380534(0x214)]);}[_0x67e027(0x242)](){const _0x55fa1f=_0x67e027;process['on'](_0x55fa1f(0x1d9),_0x514a02=>{const _0x394e2d=_0x55fa1f;log('error',_0x394e2d(0x20f),_0x514a02);}),process['on'](_0x55fa1f(0x1db),(_0x284bd8,_0x29a18e)=>{const _0x1f534e=_0x55fa1f;log(_0x1f534e(0x247),'Unhandled\x20Rejection\x20at:',_0x29a18e,_0x1f534e(0x249),_0x284bd8);});const _0x5b7216=async _0x4abc45=>{const _0x2f5f9f=_0x55fa1f;log(_0x2f5f9f(0x1ef),_0x2f5f9f(0x1f4)+_0x4abc45+_0x2f5f9f(0x227)),this[_0x2f5f9f(0x1d8)][_0x2f5f9f(0x21e)][_0x2f5f9f(0x216)](_0x4ffc9f=>{const _0x376d16=_0x2f5f9f;_0x4ffc9f[_0x376d16(0x224)](0x3e9,_0x376d16(0x232));}),this[_0x2f5f9f(0x1d8)][_0x2f5f9f(0x224)](()=>{const _0x28f757=_0x2f5f9f;log(_0x28f757(0x1ef),_0x28f757(0x1f8)),process['exit'](0x0);}),setTimeout(()=>{const _0x248e80=_0x2f5f9f;log(_0x248e80(0x247),'Forced\x20shutdown\x20after\x20timeout'),process[_0x248e80(0x20d)](0x1);},0x2710);};process['on'](_0x55fa1f(0x201),()=>_0x5b7216('SIGTERM')),process['on'](_0x55fa1f(0x239),()=>_0x5b7216(_0x55fa1f(0x239)));}[_0x67e027(0x1e6)](_0x30c2cc,_0x655bb9,_0x4997fa){const _0x2d5ec6=_0x67e027;try{if(_0x30c2cc[_0x2d5ec6(0x219)]<0x13)throw new Error(_0x2d5ec6(0x233));const _0x39e716=new MessageParser(_0x30c2cc),_0x2ff024=_0x39e716[_0x2d5ec6(0x24a)]();if(!this['connectionManager'][_0x2d5ec6(0x20c)][_0x2d5ec6(0x231)](_0x2ff024[_0x2d5ec6(0x228)])){log(_0x2d5ec6(0x23d),'Unauthorized\x20connection\x20attempt\x20with\x20UUID:\x20'+_0x2ff024[_0x2d5ec6(0x228)]+_0x2d5ec6(0x234)+_0x4997fa),_0x655bb9[_0x2d5ec6(0x224)](0x3f0,_0x2d5ec6(0x23b));return;}_0x655bb9[_0x2d5ec6(0x1eb)](new Uint8Array([_0x2ff024[_0x2d5ec6(0x218)],0x0]));const _0x593e4a=createWebSocketStream(_0x655bb9,{'encoding':_0x2d5ec6(0x1fa),'decodeStrings':![],'highWaterMark':0x8000});this[_0x2d5ec6(0x1de)](_0x2ff024,_0x593e4a);}catch(_0x28314e){log(_0x2d5ec6(0x247),_0x2d5ec6(0x1f6)+_0x4997fa+':',_0x28314e),_0x655bb9[_0x2d5ec6(0x224)](0x3f0,_0x2d5ec6(0x1e0));}}[_0x67e027(0x1de)](_0x2b2c98,_0xd6bd71){const _0x3351f5=_0x67e027,_0x1819d8=net[_0x3351f5(0x229)]({'host':_0x2b2c98[_0x3351f5(0x22d)],'port':_0x2b2c98[_0x3351f5(0x21f)],'timeout':config['CONNECTION_TIMEOUT']});_0x1819d8[_0x3351f5(0x246)]('connect',function(){const _0x3f4c01=_0x3351f5;log(_0x3f4c01(0x1ef),'Connected\x20to\x20'+_0x2b2c98[_0x3f4c01(0x22d)]+':'+_0x2b2c98['port']+'\x20(UUID:\x20'+_0x2b2c98[_0x3f4c01(0x228)]+')');_0x2b2c98[_0x3f4c01(0x213)]&&this[_0x3f4c01(0x1ec)](_0x2b2c98['data']);const _0x18fef4=new ThrottleStream(config['RATE_LIMIT_BYTES']),_0x366390=new ThrottleStream(config[_0x3f4c01(0x230)]);_0xd6bd71['on'](_0x3f4c01(0x247),_0x17d54e=>{const _0x3940a0=_0x3f4c01;log(_0x3940a0(0x247),_0x3940a0(0x211)+_0x2b2c98[_0x3940a0(0x22d)]+':'+_0x2b2c98[_0x3940a0(0x21f)]+':',_0x17d54e),_0x1819d8[_0x3940a0(0x237)]();})[_0x3f4c01(0x208)](_0x18fef4)[_0x3f4c01(0x208)](_0x1819d8)['on'](_0x3f4c01(0x247),_0x55ba6a=>{const _0x14e9ec=_0x3f4c01;log(_0x14e9ec(0x247),_0x14e9ec(0x21d)+_0x2b2c98[_0x14e9ec(0x22d)]+':'+_0x2b2c98[_0x14e9ec(0x21f)]+':',_0x55ba6a),_0xd6bd71[_0x14e9ec(0x237)]();})[_0x3f4c01(0x208)](_0x366390)[_0x3f4c01(0x208)](_0xd6bd71);}),_0x1819d8['on']('timeout',()=>{const _0x110352=_0x3351f5;log('warn',_0x110352(0x24c)+_0x2b2c98[_0x110352(0x22d)]+':'+_0x2b2c98[_0x110352(0x21f)]),_0x1819d8['destroy']();}),_0x1819d8['on']('error',_0x394590=>{const _0x3f14d8=_0x3351f5;log(_0x3f14d8(0x247),'Error\x20connecting\x20to\x20'+_0x2b2c98[_0x3f14d8(0x22d)]+':'+_0x2b2c98[_0x3f14d8(0x21f)]+':',_0x394590),_0xd6bd71[_0x3f14d8(0x237)]();});}}class MessageParser{constructor(_0x5c14e3){const _0x16e83b=_0x67e027;this[_0x16e83b(0x1dd)]=_0x5c14e3,this[_0x16e83b(0x1ee)]=0x0;}[_0x67e027(0x204)](_0x113d9c){const _0x2eac68=_0x67e027,_0x319e4d=this[_0x2eac68(0x1dd)][_0x2eac68(0x24b)](this['offset'],this[_0x2eac68(0x1ee)]+_0x113d9c);return this[_0x2eac68(0x1ee)]+=_0x113d9c,_0x319e4d;}[_0x67e027(0x212)](){const _0x784813=_0x67e027,_0x438aae=this[_0x784813(0x1dd)]['readUInt8'](this[_0x784813(0x1ee)]);return this[_0x784813(0x1ee)]+=0x1,_0x438aae;}[_0x67e027(0x24e)](){const _0x408156=_0x67e027,_0x50d592=this[_0x408156(0x1dd)][_0x408156(0x24e)](this[_0x408156(0x1ee)]);return this[_0x408156(0x1ee)]+=0x2,_0x50d592;}[_0x67e027(0x24a)](){const _0x4625bc=_0x67e027,_0x45d4d0=this['readUInt8'](),_0x44016e=this[_0x4625bc(0x204)](0x10)['toString'](_0x4625bc(0x1e3)),_0x5694d6=this[_0x4625bc(0x212)]();this[_0x4625bc(0x1ee)]+=_0x5694d6;const _0x3a60a4=this['readUInt16BE'](),_0x3105e2=this[_0x4625bc(0x212)](),_0x968c55=this[_0x4625bc(0x236)](_0x3105e2),_0x32019a=this[_0x4625bc(0x1dd)][_0x4625bc(0x24b)](this[_0x4625bc(0x1ee)]);return{'version':_0x45d4d0,'uuid':_0x44016e,'port':_0x3a60a4,'host':_0x968c55,'data':_0x32019a,'addressType':_0x3105e2};}['parseAddress'](_0x17bb48){const _0x5d5200=_0x67e027;switch(_0x17bb48){case 0x1:return this['readBytes'](0x4)['join']('.');case 0x2:{const _0xdb6a83=this[_0x5d5200(0x212)]();return new TextDecoder()['decode'](this[_0x5d5200(0x204)](_0xdb6a83));}case 0x3:{const _0x2f8198=this['readBytes'](0x10),_0x3e21a4=[];for(let _0x5a2c79=0x0;_0x5a2c79<0x10;_0x5a2c79+=0x2){_0x3e21a4['push'](_0x2f8198[_0x5d5200(0x24e)](_0x5a2c79)[_0x5d5200(0x21b)](0x10));}return _0x3e21a4[_0x5d5200(0x1ed)](':');}default:throw new Error(_0x5d5200(0x24d)+_0x17bb48);}}}new WebSocketProxyServer(),log('info',_0x67e027(0x1d6)+config[_0x67e027(0x1fc)]/0xf4240+_0x67e027(0x23f));